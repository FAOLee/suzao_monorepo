addEventListener("load",()=>{new Vue({el:"#memberInterest",data(){const t="/frontend/assets/layout/icon-member",e=".png?ver=20250220";return{loading:!0,btnLoading:!0,contentData:{title:"会员尊享以下免费权益",list:[{img:t+"1"+e,title:"物性表详情",tip:"免费无限查看"},{img:t+"2"+e,title:"物性表下载",tip:"免费无水印下载"},{img:t+"3"+e,title:"高级性能搜索",tip:"免费无限使用"},{img:t+"4"+e,title:"AI智能选材",tip:"免费无限使用"},{img:t+"5"+e,title:"对比功能/下载",tip:"支持无水印"}]},goodsList:[],payTab:[{icon:"/frontend/assets/page/pay/pay-wx.png",text:"微信支付",id:"wx_pay"},{icon:"/frontend/assets/page/pay/pay-zfb.png",text:"支付宝支付",id:"ali_pay"}],goodsId:"",payId:"wx_pay",wxTimer:null,QRCode:"",vipStatus:"off",vipOrder:{orderNo:"",payReturn:""},isDefaultGoodsList:{},agree:!0}},created(){this.init()},watch:{goodsPayId:{async handler(t,e){if(t){try{this.btnLoading=!0;const{code:t,data:e}=await this.createVipOrder(this.goodsId,this.payId);101===t&&e?(this.vipOrder=e,this.goPay(e.payReturn,this.payId)):this.vipOrder={orderNo:"",payReturn:""}}catch(t){console.error(t),this.vipOrder={orderNo:"",payReturn:""}}this.btnLoading=!1}}}},computed:{goodsPayId(){return this.goodsId+this.payId},payBtnDay(){return this.isDefaultGoodsList.validityTime},payBtnPrice(){return this.isDefaultGoodsList.price}},filters:{},methods:{async init(){this.openMemberInterest(),this.polymerizationInfo(),this.loading=!1},async polymerizationInfo(){try{const t=await fetch("/core/enterprise/polymerizationInfo"),{data:e}=await t.json();e&&e.vipStatus&&(this.vipStatus=e.vipStatus)}catch(t){console.error(t)}},getGoodsList:()=>new Promise((t,e)=>{fetch("/core/vipTrade/getGoodsList",{headers:{"X-Requested-With":"XMLHttpRequest","Client-Type":2}}).then(t=>t.json()).then(t).catch(e)}),async openMemberInterest(){try{const{code:t,data:e,msg:i}=await this.getGoodsList();if(101===t&&e){this.goodsList=e;const t=e.find(t=>t.isDefault);return void(t?this.tabGoodsList(t):this.tabGoodsList(e[0]))}this.$message.error(i)}catch(t){console.error(t)}},tabGoodsList(t){this.goodsId=t.id,this.isDefaultGoodsList=t},async tabPayTab(t){if(this.payId!==t)try{const{code:e,data:i}=await this.createVipOrder(this.goodsId,t);101===e&&i&&(this.vipOrder=i,this.goPay(i.payReturn,t))}catch(t){console.error(t),this.vipOrder={orderNo:"",payReturn:""}}},getOrderDetail(t){if(t)return new Promise((e,i)=>{fetch("/core/vipTrade/getVipOrderDetail?orderNo="+t,{headers:{"X-Requested-With":"XMLHttpRequest","Client-Type":2}}).then(t=>t.json()).then(e).catch(i)})},createVipOrder:(t,e)=>new Promise((i,s)=>{fetch("/core/vipTrade/createVipOrder",{headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json","Client-Type":2},method:"POST",body:JSON.stringify({goodsId:t,payType:e})}).then(t=>t.json()).then(i).catch(s)}),goPay(t,e){if(this.agree||this.$message({message:"请阅读并同意《平台信息服务协议》",type:"success"}),"wx_pay"===e&&(this.QRCode=t),"ali_pay"===e){let e=document.getElementsByTagName("divform");e.length&&document.body.removeChild(e[0]);const i=document.createElement("divform");i.innerHTML=t,i.querySelector("form").setAttribute("target","_blank"),document.body.appendChild(i)}},mobilePay(){document.querySelector("divform form").submit()}}})});