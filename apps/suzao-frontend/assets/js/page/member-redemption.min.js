addEventListener("load",()=>{new Vue({el:"#memberRedemption",data:()=>({form:{exchangeCode:""},rules:{exchangeCode:[{required:!0,message:"兑换码必填",trigger:"input"}]}}),created(){},methods:{exchangeVip(){const e=new FormData;return e.append("exchangeCode",this.form.exchangeCode),new Promise((t,a)=>{fetch("/core/vipTrade/exchangeVip",{headers:{"X-Requested-With":"XMLHttpRequest"},method:"POST",body:e}).then(e=>e.json()).then(t).catch(a)})},submitForm(){this.$refs.formRef.validate(async e=>{if(!e)return!1;{const{code:e,msg:t}=await this.exchangeVip();if(101===e)return this.$message({type:"success",message:t}),void(this.form.exchangeCode="");this.handleApiError(t)}})},handleApiError(e){this.$refs.formRef.validateField("exchangeCode",t=>{t||this.$refs.formRef.fields.forEach(t=>{"exchangeCode"===t.prop&&(t.validateMessage=e,t.validateState="error")})})}}})});