addEventListener("load",()=>{const t=new marked.Renderer,e=new marked.Renderer,i=t=>{const e=/\$\$([^$]+)\$\$/g,i=/\$([^$]+)\$/g;return t.replace(e,(t,e)=>{try{return katex.renderToString(e,{displayMode:!0,output:"html"})}catch(e){return t}}).replace(i,(t,e)=>{try{return katex.renderToString(e,{displayMode:!1})}catch(e){return t}})};t.codespan=(t=>{const n=i(t);return e.codespan(n)}),t.blockquote=(t=>{const n=i(t);return e.blockquote(n)}),t.listitem=((t,n,s)=>{const a=i(t);return e.listitem(a,n,s)}),t.paragraph=(t=>{const n=i(t);return e.paragraph(n)});const n={renderer:t,langPrefix:"hljs language-",highlight(t,e,i){const n=hljs.getLanguage(e)?e:"plaintext";return hljs.highlight(t,{language:n}).value}};marked.setOptions(n),Vue.component("chat-feedback",{props:{item:{type:Object}},inject:["backBottom","renderStart","renderEnd","openShowCorrect","handleSearch","openBecomeDialog","questionAgain","copyText","openList"],data:()=>({foldingState:!1}),created(){this.renderStart()},mounted(){this.init()},computed:{lickActive(){return this.item.isLike},dissActive(){return this.item.isDiss},contentClassName(){return this.item.className+" "+this.item.ansResultType}},methods:{init(){this.backBottom(),this.renderEnd()},eventRetry(t){this.questionAgain(t.ansId,t.conId)},eventCopy(t){const e=this.$refs["more"+t.ansId].nextSibling;if(!e||!window.getSelection)return;const i=window.getSelection(),n=document.createRange();n.selectNodeContents(e),i.removeAllRanges(),i.addRange(n),document.execCommand("copy"),i.empty(),this.$message({type:"success",message:"复制成功"})},eventLike(t){const e=this;$axios({url:"/core/dm/botAPI/likeOrDis",method:"post",data:{ansId:this.item.ansId,operateType:1}}).then(t=>{101===t.code?e.lickActive?e.item.isLike=!1:(e.item.isLike=!0,e.item.isDiss=!1):e.$message.error(t.msg)}).catch(console.error)},eventDislikes(t){if(this.dissActive){const t=this;$axios({url:"/core/dm/botAPI/likeOrDis",method:"post",data:{ansId:this.item.ansId,operateType:2}}).then(e=>{101===e.code?t.dissActive?t.item.isDiss=!1:(t.item.isDiss=!0,t.item.isLike=!1):t.$message.error(e.msg)}).catch(console.error)}else this.openShowCorrect(t)},changeList(t){this.foldingState=!this.foldingState,this.openList(t.ansId,t.conId)},toLink(t){const e="/plastic/search?view=4",i={ansId:t.ansId||"",convId:t.convId||"",queryContent:t.queryContent||"",ansResultType:t.ansResultType||"",uuid:t.uuid||""};return e+"&"+new URLSearchParams(i).toString()}},template:'\n      <div :class="contentClassName" :ref="\'more\' + item.ansId">\n        <div class="operate-btn retry" @click="eventRetry(item)"><i class="iconfont icon-icon_zhongshi"></i> 重试</div>\n        <div v-if="item.ansId" class="operate-btn copy" @click="eventCopy(item)"><i class="el-icon-document-copy"></i> 复制</div>\n        <div v-if="item.ansId" :class="{\'operate-btn\':true, active: lickActive, like:true}" @click="eventLike(item.ansId)"><i class="el-icon-check"></i> 对</div>\n        <div v-if="item.ansId" :class="{\'operate-btn\':true, active: dissActive, dislikes:true}" @click="eventDislikes(item.ansId)"><i class="el-icon-close"></i> 错</div>\n        <div class="right-flex-end">\n          <div class="operate-btn become" v-if="item.ansResultType === \'ENTERPRISE\'" @click="openBecomeDialog(item)"><i class="iconfont el-icon-edit"></i> 申请成为商家</div>\n          <a v-if="![\'ENTERPRISE\',\'REPLACE01\'].includes(item.ansResultType) && item.total > item.length" class="operate-btn" target=\'_blank\' :href="toLink(item)">\n            查看更多<span class="color">{{item.total}}条</span>相关内容<i class="iconfont el-icon-arrow-right"></i>\n          </a>\n          <div v-if="[\'REPLACE01\'].includes(item.ansResultType) && item.total > 6" class="operate-btn text" :class="{foldingState:foldingState}" @click="changeList(item)">\n            <div class="open">查看更多 <i class="el-icon-arrow-down"></i></div>\n            <div class="close">收起 <i class="el-icon-arrow-up"></i></div>\n          </div>\n        </div>\n      </div>\n      '}),Vue.component("chat-display",{props:{item:{type:Object}},computed:{htmlString(){return this.item.htmlString},loading(){return this.item.transitionLoading}},inject:["backBottom","backBottom2","renderStart","renderEnd","handleSearch"],created(){this.renderStart()},mounted(){this.init()},methods:{init(){this.backBottom(),this.renderEnd()},search(t){const e=this;this.backBottom2(),setTimeout(()=>{e.handleSearch({key:t,queryType:e.item.ansId?4:2})},300)}},template:'<div :class="loading? \'cursor \' + item.className : item.className" v-html="htmlString"></div>'}),Vue.component("chat-init",{props:{item:{type:Object}},computed:{textList(){return this.item.text}},data:()=>({text:[],titleTip:""}),inject:["backBottom","backBottom2","renderStart","renderEnd","handleSearch","myRandom"],created(){this.renderStart()},mounted(){this.init()},methods:{init(){this.toggle(),this.updated(),this.backBottom(),this.renderEnd()},toggle(){this.text=this.myRandom(this.textList,4)},updated(){let t=0,e=null;const i=128,n=this.item.titleTip,s=a=>{e||(e=a);const r=a-e;r>i&&t<=n.length&&(this.titleTip+=n.slice(t-1,t),t++,e=a),t<=n.length&&requestAnimationFrame(s)};requestAnimationFrame(s)},search(t){const e=this;this.backBottom2(),setTimeout(()=>{e.handleSearch({key:t,queryType:e.item.ansId?4:2})},300)}},template:'\n      <div :class="item.className">\n        <div class="tip-content" :style="item.colorString">\n          <div class="new" v-if="item.titleTip">{{titleTip}}</div>\n          <div v-if="item.title">{{item.title}}</div>\n          <a v-if="item.btn && item.btn.url && item.btn.content" :href="item.btn.url" target="_blank" class="learn-more">{{item.btn.content}}</a>\n        </div>\n        <div class="recommend-content">\n          <div class="tip"><div>{{item.tip}}</div><div class="operate-btn" @click="toggle"><i class="iconfont icon-icon_zhongshi"></i> 换一换</div></div>\n          <div class="box"><p class="text" v-for="it in text"><span @click="search(it)">{{it}}</span></p></div>\n        </div>\n      </div>\n      '}),Vue.component("chat-recommend",{props:{item:{type:Object}},computed:{text(){return this.item.text}},inject:["backBottom","backBottom2","renderStart","renderEnd","handleSearch"],created(){this.renderStart()},mounted(){this.init()},methods:{init(){this.backBottom(),this.renderEnd()},search(t){const e=this;this.backBottom2(),setTimeout(()=>{e.handleSearch({key:t,queryType:e.item.ansId?4:2})},300)}},template:'\n      <div :class="item.className">\n        <div class="tip" v-if="item.tip">{{item.tip}}</div>\n        <p class="text" v-for="it in text"><span @click="search(it)">{{it}}</span></p>\n      </div>\n      '}),Vue.component("chat-form",{props:{item:{type:Object}},data:()=>({randomKey:Math.random()}),inject:["backBottom","renderStart","renderEnd","replaceFormList","memberIndustry"],created(){this.renderStart(),this.item.industry&&(this.item.industry=[]),this.item.company&&(this.item.company=""),this.item.name&&(this.item.name=""),this.randomKey=Math.random()},computed:{industryAll(){return this.$parent.memberIndustry.concat()}},mounted(){this.init()},methods:{init(){this.backBottom(),this.renderEnd()},submitForm(){const t=this;this.$refs["chatForm"+this.item.ansId].validate(e=>{if(!e)return;if(!t.item.industry.length&&!t.item.company&&!t.item.name)return;const i=new FormData;t.item.industry.length&&i.append("industry",t.item.industry.join(",")),t.item.company&&i.append("company",t.item.company),t.item.name&&i.append("name",t.item.name),axios({url:"/member/fillInfo",method:"post",data:i,params:{scene:"apply"}}).then(e=>{e.data&&1===e.data.status&&(t.$message({type:"success",message:"保存成功!"}),t.replaceFormList())}).catch(console.error)})},itemQuerySearch(t,e){if(t.length<2)return;const i=new URLSearchParams;i.append("key",t),axios({url:"/vendor/autocompleteAddress",method:"post",data:i,params:{act:"company"}}).then(t=>{if(200===t.status){const i=t.data;if(1===i.status){if(0===i.data.length)return e([]);const t=i.data.map(t=>({value:t}));return e(t)}}return e([])}).catch(t=>{e([])})}},template:`\n      <div class="form-content">\n        <div class="title">\n          ${CHAT_TEXT.formTitle}\n        </div>\n        <div class="tip">\n          ${CHAT_TEXT.formTip}\n        </div>\n        <el-row :gutter="30" type="flex">\n          <el-form :model="item" :ref="'chatForm' + item.ansId" :key="randomKey">\n            <el-col :span="12">\n              <el-form-item v-if="item.name !== false" prop="name">\n                <el-input v-model="item.name" placeholder="请输入姓名"></el-input>\n              </el-form-item>\n            </el-col>\n            <el-col :span="12">\n              <el-form-item v-if="item.industry" prop="industry">\n                <el-select v-model="item.industry" filterable placeholder="请输入应用行业" clearable default-first-option allow-create multiple collapse-tags>\n                  <el-option v-for="(it, ind) in industryAll" :key="ind" :label="it" :value="it"></el-option>\n                </el-select>\n              </el-form-item>\n            </el-col>\n            <el-col :span="12">\n              <el-form-item v-if="item.company !== false" prop="company">\n                <el-autocomplete v-model="item.company" :fetch-suggestions="itemQuerySearch" :trigger-on-focus="false" placeholder="请输入公司"></el-autocomplete>\n              </el-form-item>\n            </el-col>\n            <el-col :span="24">\n              <el-form-item>\n                <el-button type="primary" class="color-btn" @click="submitForm">确认</el-button>\n              </el-form-item>\n            </el-col>\n          </el-form>\n        </el-row>\n      </div>\n     `}),Vue.component("chat-business",{props:{item:{type:Object}},computed:{list(){return this.item.list}},inject:["backBottom","renderStart","renderEnd"],filters:{label_translate:t=>1===t?"代理商":2===t?"生产厂家":void 0,max_mfrs:t=>t.length>3?(t.length=3,t.join("·")+"..."):t.join("·"),gender_type:t=>1===t?"先生":0===t?"女士":""},created(){this.renderStart()},mounted(){this.init()},methods:{init(){this.backBottom(),this.renderEnd()},linkFormat(t){const e={view:4};return e.ansId=this.item.ansId,e.convId=this.item.convId,t.id&&(e.eid=t.id),t.mid&&(e.mid=t.mid),t.cid&&(e.cid=t.cid),"/plastic/search?"+new URLSearchParams(e).toString()}},template:`\n      <div :class="item.className">\n        <div class="tip">\n          ${CHAT_TEXT.business}\n        </div>\n        <ul class="ul">\n          <li class="li" v-for="it in list">\n            <a :href="linkFormat(it)" class="box" target="_blank">\n              <div class="title"><span class="name"><span v-if="it.type === 1">{{it.mfrsSet|max_mfrs}}&nbsp;</span>{{ it.type | label_translate }}</span> <i class="icon el-icon-arrow-right"></i></div>\n              <div class="text">{{it.companyName}}</div>\n              <div class="text">{{it.surname}} {{it.gender | gender_type}}</div>\n              <div class="text"><span class="formatPhone" data-sensors-click :data-phone="suzao.formatPhone(it.cellphone)"><i class="iconfont icon-icon_dianhua"></i>查看电话</span></div>\n              <div class="text">{{it.contactEmail}}</div>\n            </a>\n          </li>\n        </ul>\n      </div>\n      `}),Vue.component("chat-compare",{props:{item:{type:Object}},inject:["backBottom","renderStart","renderEnd"],created(){this.renderStart()},mounted(){this.init()},methods:{init(){this.backBottom(),this.renderEnd()},linkFormat:t=>"/plastic/compareV2?code="+t},template:` \n      <div :class="item.className">\n        <div class="tip">\n          ${CHAT_TEXT.compare}\n        </div>\n        <a :href="linkFormat(item.code)" class="operate-btn" target="_blank"><img class="icon-pk" src="/frontend/assets/ai/pk.png?ver=2024030401"> 查看对比结果</a>\n      </div>\n      `}),Vue.component("chat-commodity",{props:{item:{type:Object}},computed:{list(){return this.item.commodityVOList}},inject:["backBottom","renderStart","renderEnd"],filters:{},created(){this.renderStart()},mounted(){this.init()},methods:{init(){this.backBottom(),this.renderEnd()},linkFormat(t){if(!t.uuid)return"";const e={id:t.uuid};return e.ansId=this.item.ansId,e.convId=this.item.convId,"/plastic/detail?"+new URLSearchParams(e).toString()}},template:'\n      <div :class="item.className">\n        <div class="tip">{{item.ansShowTips}}</div>\n        <div class="content">\n          <ul class="ul">\n            <li class="li" v-for="it in list">\n              <a :href="linkFormat(it)" class="box" target="_blank">\n                <div class="pic"><img v-if="it.picUrl" class="img" :src="it.picUrl"></div>\n                <div class="con">\n                  <div v-if="it.companyName" class="title"><span v-if="it.companyType" class="tip">{{ it.companyType }}</span><span class="company">{{ it.companyName }}</span></div>\n                  <div v-if="it.name" class="name">{{it.name}}</div>\n                  <div v-if="it.seller" class="seller">{{it.seller}}</div>\n                  <div v-if="it.email" class="email">{{it.email}}</div>\n                  <div v-if="it.cellphone" class="text"><span class="formatPhone" data-sensors-click :data-phone="suzao.formatPhone(it.cellphone)"><i class="iconfont icon-icon_dianhua"></i>查看电话</span></div>\n                </div>\n              </a>\n            </li>\n          </ul>\n        </div>\n      </div>\n      '}),Vue.component("chat-replace",{props:{item:{type:Object}},computed:{htmlString(){return this.item.htmlString},loading(){return this.item.transitionLoading}},inject:["backBottom","backBottom2","renderStart","renderEnd","handleSearch"],created(){this.renderStart()},mounted(){this.init()},methods:{init(){this.backBottom(),this.renderEnd()},firstItemLine(t){if(t.firstItemLine){const e={uuid:t.lineUuId};let i="";return t.firstItemLine.map(t=>{t.itemValue&&(e[t.itemLabel]=t.itemValue,i+=`<span class="${t.itemLabel}">${t.itemValue}</span>`)}),i}return t},search(t){const e=this;this.backBottom2();let i="";t.firstItemLine&&t.firstItemLine.map(t=>{t.itemValue&&(i+=`${t.itemValue}`)}),setTimeout(()=>{e.handleSearch({key:`找${i}的替代材料`,queryType:6,uuid:t.lineUuId})},300)}},template:'\n      <div :class="item.className">\n        <div class="tip">为了帮您推荐更精准的替代材料，请按提示选择完善的材料信息。</div>\n        <div class="tip">您要找的是以下哪个牌号的替代材料，请选择：</div>\n        <ul :class="{ul:true,open: item.foldingState}">\n          <li class="li" v-for="(it,index) in item.ansLines" :key="index" @click="search(it)">{{index + 1}}. <span v-html="firstItemLine(it)"><span></li>\n        </ul>\n      </div>\n      '}),Vue.component("chat-replace-compare",{props:{item:{type:Object}},computed:{},inject:["backBottom","renderStart","renderEnd","openReplaceDialog"],created(){this.renderStart()},mounted(){this.init()},methods:{init(){this.backBottom(),this.renderEnd()},firstItemLine:t=>t.firstItemLine?`${t.firstItemLine.zhname} ${t.firstItemLine.name} ${t.firstItemLine.sp_name} ${t.firstItemLine.p_base_gradeno}`:t},template:'\n      <div :class="item.className" @click="openReplaceDialog(item)">\n        点击查看<span class="title" v-html="firstItemLine(item)"></span>与替代牌号物性对比表\n      </div>\n      '}),Vue.component("chat-formula",{props:{item:{type:Object}},computed:{},inject:["backBottom","renderStart","renderEnd"],created(){this.renderStart()},mounted(){this.init()},methods:{init(){this.backBottom(),this.renderEnd()}},template:'\n      <div :class="item.className">\n        <div class="tip">{{item.ansShowTips || "材料配方"}}</div>\n          <div v-for="(formulas,index) in item.formulas" class="formulas" :key="index">\n        <div class="title"><span>{{formulas.name}}</span></div>\n        <el-table :data="formulas.items" border size="mini">\n          <el-table-column prop="name" label="材料种类"></el-table-column>\n          <el-table-column prop="dataPlasticList" label="材料名称">\n          <template slot-scope="{row}">\n            <div v-for="dataPlastic in row.dataPlasticList" class="plastic" :key="dataPlastic.id"><el-link :href="\'/plastic/detail?id=\' + dataPlastic.uuid" target="_blank">{{dataPlastic.gradeno}}</el-link></div>\n          </template>\n          </el-table-column>\n          <el-table-column prop="ratio" label="配比%">\n            <template slot-scope="{row}">{{row.ratio||0}}%</template>\n          </el-table-column>\n        </el-table>\n      </div>\n      '})});